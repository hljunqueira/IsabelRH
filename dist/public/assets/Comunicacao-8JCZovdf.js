import{c as J,A as _e,r as a,D as G,J as Oe,j as e,a7 as K,a8 as Z,N as F,K as $,F as ze,ay as Ve,V as ve,S as ge,I as he,a2 as ue,a4 as xe,B as H,g as y,Z as He,aa as We,_ as Be,$ as $e,a0 as se,h as Fe,a1 as te,C as W,a as X,b as Y,d as B,ac as Ue}from"./index-w5tiW1w6.js";import{A as ae,a as oe,b as ne}from"./avatar-Bbl-0o0s.js";import{P as Xe}from"./phone-vBu-zhUN.js";import{S as Ye}from"./send-DaHoU4TK.js";import{M as be}from"./message-square-D8j9dvbj.js";import{P as qe}from"./plus-h6AN3lvn.js";import{T as Je}from"./trash-2-aVLccz48.js";import{F as Ge}from"./filter-BEW7zRcC.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=J("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=J("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=J("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=J("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=J("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=J("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);function er(r,t){return a.useReducer((o,n)=>t[o][n]??o,r)}var ce="ScrollArea",[we,Nr]=_e(ce),[rr,R]=we(ce),Se=a.forwardRef((r,t)=>{const{__scopeScrollArea:o,type:n="hover",dir:s,scrollHideDelay:c=600,...d}=r,[m,h]=a.useState(null),[x,u]=a.useState(null),[v,p]=a.useState(null),[g,j]=a.useState(null),[E,_]=a.useState(null),[P,A]=a.useState(0),[O,L]=a.useState(0),[T,D]=a.useState(!1),[z,k]=a.useState(!1),l=G(t,i=>h(i)),b=Oe(s);return e.jsx(rr,{scope:o,type:n,dir:b,scrollHideDelay:c,scrollArea:m,viewport:x,onViewportChange:u,content:v,onContentChange:p,scrollbarX:g,onScrollbarXChange:j,scrollbarXEnabled:T,onScrollbarXEnabledChange:D,scrollbarY:E,onScrollbarYChange:_,scrollbarYEnabled:z,onScrollbarYEnabledChange:k,onCornerWidthChange:A,onCornerHeightChange:L,children:e.jsx(K.div,{dir:b,...d,ref:l,style:{position:"relative","--radix-scroll-area-corner-width":P+"px","--radix-scroll-area-corner-height":O+"px",...r.style}})})});Se.displayName=ce;var Ne="ScrollAreaViewport",ye=a.forwardRef((r,t)=>{const{__scopeScrollArea:o,children:n,nonce:s,...c}=r,d=R(Ne,o),m=a.useRef(null),h=G(t,m,d.onViewportChange);return e.jsxs(e.Fragment,{children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),e.jsx(K.div,{"data-radix-scroll-area-viewport":"",...c,ref:h,style:{overflowX:d.scrollbarXEnabled?"scroll":"hidden",overflowY:d.scrollbarYEnabled?"scroll":"hidden",...r.style},children:e.jsx("div",{ref:d.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});ye.displayName=Ne;var M="ScrollAreaScrollbar",ie=a.forwardRef((r,t)=>{const{forceMount:o,...n}=r,s=R(M,r.__scopeScrollArea),{onScrollbarXEnabledChange:c,onScrollbarYEnabledChange:d}=s,m=r.orientation==="horizontal";return a.useEffect(()=>(m?c(!0):d(!0),()=>{m?c(!1):d(!1)}),[m,c,d]),s.type==="hover"?e.jsx(sr,{...n,ref:t,forceMount:o}):s.type==="scroll"?e.jsx(tr,{...n,ref:t,forceMount:o}):s.type==="auto"?e.jsx(Ce,{...n,ref:t,forceMount:o}):s.type==="always"?e.jsx(de,{...n,ref:t}):null});ie.displayName=M;var sr=a.forwardRef((r,t)=>{const{forceMount:o,...n}=r,s=R(M,r.__scopeScrollArea),[c,d]=a.useState(!1);return a.useEffect(()=>{const m=s.scrollArea;let h=0;if(m){const x=()=>{window.clearTimeout(h),d(!0)},u=()=>{h=window.setTimeout(()=>d(!1),s.scrollHideDelay)};return m.addEventListener("pointerenter",x),m.addEventListener("pointerleave",u),()=>{window.clearTimeout(h),m.removeEventListener("pointerenter",x),m.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),e.jsx(Z,{present:o||c,children:e.jsx(Ce,{"data-state":c?"visible":"hidden",...n,ref:t})})}),tr=a.forwardRef((r,t)=>{const{forceMount:o,...n}=r,s=R(M,r.__scopeScrollArea),c=r.orientation==="horizontal",d=re(()=>h("SCROLL_END"),100),[m,h]=er("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return a.useEffect(()=>{if(m==="idle"){const x=window.setTimeout(()=>h("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(x)}},[m,s.scrollHideDelay,h]),a.useEffect(()=>{const x=s.viewport,u=c?"scrollLeft":"scrollTop";if(x){let v=x[u];const p=()=>{const g=x[u];v!==g&&(h("SCROLL"),d()),v=g};return x.addEventListener("scroll",p),()=>x.removeEventListener("scroll",p)}},[s.viewport,c,h,d]),e.jsx(Z,{present:o||m!=="hidden",children:e.jsx(de,{"data-state":m==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:F(r.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:F(r.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),Ce=a.forwardRef((r,t)=>{const o=R(M,r.__scopeScrollArea),{forceMount:n,...s}=r,[c,d]=a.useState(!1),m=r.orientation==="horizontal",h=re(()=>{if(o.viewport){const x=o.viewport.offsetWidth<o.viewport.scrollWidth,u=o.viewport.offsetHeight<o.viewport.scrollHeight;d(m?x:u)}},10);return q(o.viewport,h),q(o.content,h),e.jsx(Z,{present:n||c,children:e.jsx(de,{"data-state":c?"visible":"hidden",...s,ref:t})})}),de=a.forwardRef((r,t)=>{const{orientation:o="vertical",...n}=r,s=R(M,r.__scopeScrollArea),c=a.useRef(null),d=a.useRef(0),[m,h]=a.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),x=Ae(m.viewport,m.content),u={...n,sizes:m,onSizesChange:h,hasThumb:x>0&&x<1,onThumbChange:p=>c.current=p,onThumbPointerUp:()=>d.current=0,onThumbPointerDown:p=>d.current=p};function v(p,g){return ir(p,d.current,m,g)}return o==="horizontal"?e.jsx(ar,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&c.current){const p=s.viewport.scrollLeft,g=pe(p,m,s.dir);c.current.style.transform=`translate3d(${g}px, 0, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollLeft=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollLeft=v(p,s.dir))}}):o==="vertical"?e.jsx(or,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&c.current){const p=s.viewport.scrollTop,g=pe(p,m);c.current.style.transform=`translate3d(0, ${g}px, 0)`}},onWheelScroll:p=>{s.viewport&&(s.viewport.scrollTop=p)},onDragScroll:p=>{s.viewport&&(s.viewport.scrollTop=v(p))}}):null}),ar=a.forwardRef((r,t)=>{const{sizes:o,onSizesChange:n,...s}=r,c=R(M,r.__scopeScrollArea),[d,m]=a.useState(),h=a.useRef(null),x=G(t,h,c.onScrollbarXChange);return a.useEffect(()=>{h.current&&m(getComputedStyle(h.current))},[h]),e.jsx(Pe,{"data-orientation":"horizontal",...s,ref:x,sizes:o,style:{bottom:0,left:c.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:c.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ee(o)+"px",...r.style},onThumbPointerDown:u=>r.onThumbPointerDown(u.x),onDragScroll:u=>r.onDragScroll(u.x),onWheelScroll:(u,v)=>{if(c.viewport){const p=c.viewport.scrollLeft+u.deltaX;r.onWheelScroll(p),Te(p,v)&&u.preventDefault()}},onResize:()=>{h.current&&c.viewport&&d&&n({content:c.viewport.scrollWidth,viewport:c.viewport.offsetWidth,scrollbar:{size:h.current.clientWidth,paddingStart:Q(d.paddingLeft),paddingEnd:Q(d.paddingRight)}})}})}),or=a.forwardRef((r,t)=>{const{sizes:o,onSizesChange:n,...s}=r,c=R(M,r.__scopeScrollArea),[d,m]=a.useState(),h=a.useRef(null),x=G(t,h,c.onScrollbarYChange);return a.useEffect(()=>{h.current&&m(getComputedStyle(h.current))},[h]),e.jsx(Pe,{"data-orientation":"vertical",...s,ref:x,sizes:o,style:{top:0,right:c.dir==="ltr"?0:void 0,left:c.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ee(o)+"px",...r.style},onThumbPointerDown:u=>r.onThumbPointerDown(u.y),onDragScroll:u=>r.onDragScroll(u.y),onWheelScroll:(u,v)=>{if(c.viewport){const p=c.viewport.scrollTop+u.deltaY;r.onWheelScroll(p),Te(p,v)&&u.preventDefault()}},onResize:()=>{h.current&&c.viewport&&d&&n({content:c.viewport.scrollHeight,viewport:c.viewport.offsetHeight,scrollbar:{size:h.current.clientHeight,paddingStart:Q(d.paddingTop),paddingEnd:Q(d.paddingBottom)}})}})}),[nr,Ee]=we(M),Pe=a.forwardRef((r,t)=>{const{__scopeScrollArea:o,sizes:n,hasThumb:s,onThumbChange:c,onThumbPointerUp:d,onThumbPointerDown:m,onThumbPositionChange:h,onDragScroll:x,onWheelScroll:u,onResize:v,...p}=r,g=R(M,o),[j,E]=a.useState(null),_=G(t,l=>E(l)),P=a.useRef(null),A=a.useRef(""),O=g.viewport,L=n.content-n.viewport,T=$(u),D=$(h),z=re(v,10);function k(l){if(P.current){const b=l.clientX-P.current.left,i=l.clientY-P.current.top;x({x:b,y:i})}}return a.useEffect(()=>{const l=b=>{const i=b.target;(j==null?void 0:j.contains(i))&&T(b,L)};return document.addEventListener("wheel",l,{passive:!1}),()=>document.removeEventListener("wheel",l,{passive:!1})},[O,j,L,T]),a.useEffect(D,[n,D]),q(j,z),q(g.content,z),e.jsx(nr,{scope:o,scrollbar:j,hasThumb:s,onThumbChange:$(c),onThumbPointerUp:$(d),onThumbPositionChange:D,onThumbPointerDown:$(m),children:e.jsx(K.div,{...p,ref:_,style:{position:"absolute",...p.style},onPointerDown:F(r.onPointerDown,l=>{l.button===0&&(l.target.setPointerCapture(l.pointerId),P.current=j.getBoundingClientRect(),A.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),k(l))}),onPointerMove:F(r.onPointerMove,k),onPointerUp:F(r.onPointerUp,l=>{const b=l.target;b.hasPointerCapture(l.pointerId)&&b.releasePointerCapture(l.pointerId),document.body.style.webkitUserSelect=A.current,g.viewport&&(g.viewport.style.scrollBehavior=""),P.current=null})})})}),I="ScrollAreaThumb",Re=a.forwardRef((r,t)=>{const{forceMount:o,...n}=r,s=Ee(I,r.__scopeScrollArea);return e.jsx(Z,{present:o||s.hasThumb,children:e.jsx(lr,{ref:t,...n})})}),lr=a.forwardRef((r,t)=>{const{__scopeScrollArea:o,style:n,...s}=r,c=R(I,o),d=Ee(I,o),{onThumbPositionChange:m}=d,h=G(t,v=>d.onThumbChange(v)),x=a.useRef(void 0),u=re(()=>{x.current&&(x.current(),x.current=void 0)},100);return a.useEffect(()=>{const v=c.viewport;if(v){const p=()=>{if(u(),!x.current){const g=dr(v,m);x.current=g,m()}};return m(),v.addEventListener("scroll",p),()=>v.removeEventListener("scroll",p)}},[c.viewport,u,m]),e.jsx(K.div,{"data-state":d.hasThumb?"visible":"hidden",...s,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:F(r.onPointerDownCapture,v=>{const g=v.target.getBoundingClientRect(),j=v.clientX-g.left,E=v.clientY-g.top;d.onThumbPointerDown({x:j,y:E})}),onPointerUp:F(r.onPointerUp,d.onThumbPointerUp)})});Re.displayName=I;var me="ScrollAreaCorner",ke=a.forwardRef((r,t)=>{const o=R(me,r.__scopeScrollArea),n=!!(o.scrollbarX&&o.scrollbarY);return o.type!=="scroll"&&n?e.jsx(cr,{...r,ref:t}):null});ke.displayName=me;var cr=a.forwardRef((r,t)=>{const{__scopeScrollArea:o,...n}=r,s=R(me,o),[c,d]=a.useState(0),[m,h]=a.useState(0),x=!!(c&&m);return q(s.scrollbarX,()=>{var v;const u=((v=s.scrollbarX)==null?void 0:v.offsetHeight)||0;s.onCornerHeightChange(u),h(u)}),q(s.scrollbarY,()=>{var v;const u=((v=s.scrollbarY)==null?void 0:v.offsetWidth)||0;s.onCornerWidthChange(u),d(u)}),x?e.jsx(K.div,{...n,ref:t,style:{width:c,height:m,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function Q(r){return r?parseInt(r,10):0}function Ae(r,t){const o=r/t;return isNaN(o)?0:o}function ee(r){const t=Ae(r.viewport,r.content),o=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-o)*t;return Math.max(n,18)}function ir(r,t,o,n="ltr"){const s=ee(o),c=s/2,d=t||c,m=s-d,h=o.scrollbar.paddingStart+d,x=o.scrollbar.size-o.scrollbar.paddingEnd-m,u=o.content-o.viewport,v=n==="ltr"?[0,u]:[u*-1,0];return Le([h,x],v)(r)}function pe(r,t,o="ltr"){const n=ee(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,c=t.scrollbar.size-s,d=t.content-t.viewport,m=c-n,h=o==="ltr"?[0,d]:[d*-1,0],x=Ve(r,h);return Le([0,d],[0,m])(x)}function Le(r,t){return o=>{if(r[0]===r[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(r[1]-r[0]);return t[0]+n*(o-r[0])}}function Te(r,t){return r>0&&r<t}var dr=(r,t=()=>{})=>{let o={left:r.scrollLeft,top:r.scrollTop},n=0;return function s(){const c={left:r.scrollLeft,top:r.scrollTop},d=o.left!==c.left,m=o.top!==c.top;(d||m)&&t(),o=c,n=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(n)};function re(r,t){const o=$(r),n=a.useRef(0);return a.useEffect(()=>()=>window.clearTimeout(n.current),[]),a.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(o,t)},[o,t])}function q(r,t){const o=$(t);ze(()=>{let n=0;if(r){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(o)});return s.observe(r),()=>{window.cancelAnimationFrame(n),s.unobserve(r)}}},[r,o])}var De=Se,mr=ye,hr=ke;const le=a.forwardRef(({className:r,children:t,...o},n)=>e.jsxs(De,{ref:n,className:ve("relative overflow-hidden",r),...o,children:[e.jsx(mr,{className:"h-full w-full rounded-[inherit]",children:t}),e.jsx(Me,{}),e.jsx(hr,{})]}));le.displayName=De.displayName;const Me=a.forwardRef(({className:r,orientation:t="vertical",...o},n)=>e.jsx(ie,{ref:n,orientation:t,className:ve("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...o,children:e.jsx(Re,{className:"relative flex-1 rounded-full bg-border"})}));Me.displayName=ie.displayName;function ur({userId:r,userType:t}){var D,z,k;const[o,n]=a.useState([]),[s,c]=a.useState(null),[d,m]=a.useState([]),[h,x]=a.useState(""),[u,v]=a.useState(""),[p,g]=a.useState(!1),j=a.useRef(null);a.useEffect(()=>{E()},[r]),a.useEffect(()=>{s&&_(s.id)},[s]),a.useEffect(()=>{A()},[d]);const E=async()=>{g(!0);try{const l=[{id:"1",participantes:[{id:r,nome:"Você",tipo:t},{id:"2",nome:"João Silva",tipo:"candidato",avatar:"/avatar1.jpg"}],ultimaMensagem:{texto:"Obrigado pela oportunidade!",timestamp:new Date(Date.now()-18e5),remetente:"2"},naoLidas:2,ativa:!0},{id:"2",participantes:[{id:r,nome:"Você",tipo:t},{id:"3",nome:"TechCorp",tipo:"empresa",avatar:"/avatar2.jpg"}],ultimaMensagem:{texto:"Quando podemos agendar a entrevista?",timestamp:new Date(Date.now()-72e5),remetente:r},naoLidas:0,ativa:!1}];n(l)}catch(l){console.error("Erro ao carregar conversas:",l)}finally{g(!1)}},_=async l=>{try{const b=[{id:"1",texto:"Olá! Vi sua vaga e gostaria de me candidatar.",remetente:{id:"2",nome:"João Silva",tipo:"candidato"},destinatario:{id:r,nome:"Você",tipo:t},timestamp:new Date(Date.now()-36e5),lida:!0},{id:"2",texto:"Oi João! Obrigado pelo interesse. Pode me enviar seu currículo?",remetente:{id:r,nome:"Você",tipo:t},destinatario:{id:"2",nome:"João Silva",tipo:"candidato"},timestamp:new Date(Date.now()-27e5),lida:!0},{id:"3",texto:"Claro! Já enviei por email. Obrigado pela oportunidade!",remetente:{id:"2",nome:"João Silva",tipo:"candidato"},destinatario:{id:r,nome:"Você",tipo:t},timestamp:new Date(Date.now()-18e5),lida:!1}];m(b)}catch(b){console.error("Erro ao carregar mensagens:",b)}},P=async()=>{if(!h.trim()||!s)return;const l={id:Date.now().toString(),texto:h,remetente:{id:r,nome:"Você",tipo:t},destinatario:s.participantes.find(b=>b.id!==r),timestamp:new Date,lida:!1};m(b=>[...b,l]),x(""),n(b=>b.map(i=>i.id===s.id?{...i,ultimaMensagem:{texto:h,timestamp:new Date,remetente:r},naoLidas:0}:i))},A=()=>{var l;(l=j.current)==null||l.scrollIntoView({behavior:"smooth"})},O=l=>l.split(" ").map(b=>b[0]).join("").toUpperCase().slice(0,2),L=l=>l.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),T=o.filter(l=>l.participantes.some(b=>b.id!==r&&b.nome.toLowerCase().includes(u.toLowerCase())));return e.jsxs("div",{className:"flex h-[600px] bg-white rounded-lg border",children:[e.jsxs("div",{className:"w-1/3 border-r",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-400"}),e.jsx(he,{placeholder:"Pesquisar conversas...",value:u,onChange:l=>v(l.target.value),className:"border-0 focus:ring-0"})]})}),e.jsx(le,{className:"h-[calc(600px-80px)]",children:e.jsx("div",{className:"p-2",children:T.map(l=>{const b=l.participantes.find(i=>i.id!==r);return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors ${(s==null?void 0:s.id)===l.id?"bg-blue-50 border border-blue-200":""}`,onClick:()=>c(l),children:[e.jsxs("div",{className:"relative",children:[e.jsxs(ae,{className:"h-10 w-10",children:[e.jsx(oe,{src:b.avatar}),e.jsx(ne,{className:"bg-gray-200",children:b.tipo==="candidato"?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"})})]}),l.ativa&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium text-sm truncate",children:b.nome}),e.jsx("span",{className:"text-xs text-gray-500",children:L(l.ultimaMensagem.timestamp)})]}),e.jsxs("p",{className:"text-xs text-gray-600 truncate",children:[l.ultimaMensagem.remetente===r?"Você: ":"",l.ultimaMensagem.texto]})]}),l.naoLidas>0&&e.jsx(H,{variant:"destructive",className:"h-5 w-5 rounded-full p-0 text-xs",children:l.naoLidas})]},l.id)})})})]}),e.jsx("div",{className:"flex-1 flex flex-col",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(ae,{className:"h-8 w-8",children:[e.jsx(oe,{src:(D=s.participantes.find(l=>l.id!==r))==null?void 0:D.avatar}),e.jsx(ne,{className:"bg-gray-200",children:((z=s.participantes.find(l=>l.id!==r))==null?void 0:z.tipo)==="candidato"?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(xe,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:(k=s.participantes.find(l=>l.id!==r))==null?void 0:k.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:s.ativa?"Online":"Offline"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Xe,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Ze,{className:"h-4 w-4"})}),e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(je,{className:"h-4 w-4"})})]})]}),e.jsx(le,{className:"flex-1 p-4",children:e.jsxs("div",{className:"space-y-4",children:[d.map(l=>{const b=l.remetente.id===r;return e.jsx("div",{className:`flex ${b?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex items-end gap-2 max-w-[70%] ${b?"flex-row-reverse":"flex-row"}`,children:[!b&&e.jsxs(ae,{className:"h-6 w-6",children:[e.jsx(oe,{src:l.remetente.avatar}),e.jsx(ne,{className:"bg-gray-200 text-xs",children:O(l.remetente.nome)})]}),e.jsxs("div",{className:`rounded-lg px-3 py-2 ${b?"bg-blue-500 text-white":"bg-gray-100 text-gray-900"}`,children:[e.jsx("p",{className:"text-sm",children:l.texto}),e.jsxs("div",{className:`flex items-center gap-1 mt-1 ${b?"justify-end":"justify-start"}`,children:[e.jsx("span",{className:"text-xs opacity-70",children:L(l.timestamp)}),b&&e.jsx("span",{className:"text-xs opacity-70",children:l.lida?"✓✓":"✓"})]})]})]})},l.id)}),e.jsx("div",{ref:j})]})}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Ie,{className:"h-4 w-4"})}),e.jsx(he,{placeholder:"Digite sua mensagem...",value:h,onChange:l=>x(l.target.value),onKeyPress:l=>l.key==="Enter"&&P(),className:"flex-1"}),e.jsx(y,{variant:"ghost",size:"sm",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(y,{onClick:P,disabled:!h.trim(),size:"sm",children:e.jsx(Ye,{className:"h-4 w-4"})})]})})]}):e.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Selecione uma conversa para começar"})]})})})]})}function xr({userId:r,userType:t}){const[o,n]=a.useState([]),[s,c]=a.useState(null),[d,m]=a.useState([]),[h,x]=a.useState([]),[u,v]=a.useState(!1),[p,g]=a.useState(null),[j,E]=a.useState(new Set),_=a.useCallback(async()=>{v(!0),g(null);try{const i=await fetch(`/api/comunicacao/conversas?userId=${r}&userType=${t}`);if(!i.ok)throw new Error("Erro ao carregar conversas");const f=await i.json();n(f.conversas)}catch(i){g(i instanceof Error?i.message:"Erro desconhecido"),console.error("Erro ao carregar conversas:",i)}finally{v(!1)}},[r,t]),P=a.useCallback(async i=>{v(!0),g(null);try{const f=await fetch(`/api/comunicacao/conversas/${i}/mensagens`);if(!f.ok)throw new Error("Erro ao carregar mensagens");const S=await f.json();m(S.mensagens),await L(i)}catch(f){g(f instanceof Error?f.message:"Erro desconhecido"),console.error("Erro ao carregar mensagens:",f)}finally{v(!1)}},[]),A=a.useCallback(async(i,f,S)=>{if(!(!f.trim()&&(!S||S.length===0))){g(null);try{const w=new FormData;w.append("texto",f),w.append("remetenteId",r),w.append("remetenteTipo",t),S&&S.forEach(V=>{w.append("anexos",V)});const N=await fetch(`/api/comunicacao/conversas/${i}/mensagens`,{method:"POST",body:w});if(!N.ok)throw new Error("Erro ao enviar mensagem");const C=await N.json();return m(V=>[...V,C]),n(V=>V.map(U=>U.id===i?{...U,ultimaMensagem:{texto:f,timestamp:new Date,remetente:r},naoLidas:0}:U)),C}catch(w){throw g(w instanceof Error?w.message:"Erro desconhecido"),console.error("Erro ao enviar mensagem:",w),w}}},[r,t]),O=a.useCallback(async(i,f="individual",S)=>{g(null);try{const w=await fetch("/api/comunicacao/conversas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participantes:[...i,{id:r,tipo:t}],tipo:f,titulo:S,criadorId:r})});if(!w.ok)throw new Error("Erro ao criar conversa");const N=await w.json();return n(C=>[N,...C]),N}catch(w){throw g(w instanceof Error?w.message:"Erro desconhecido"),console.error("Erro ao criar conversa:",w),w}},[r,t]),L=a.useCallback(async i=>{try{await fetch(`/api/comunicacao/conversas/${i}/ler`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,userType:t})}),n(f=>f.map(S=>S.id===i?{...S,naoLidas:0}:S)),m(f=>f.map(S=>S.destinatario.id===r?{...S,lida:!0}:S))}catch(f){console.error("Erro ao marcar como lidas:",f)}},[r,t]),T=a.useCallback(async()=>{try{const i=await fetch(`/api/comunicacao/notificacoes?userId=${r}&userType=${t}`);if(!i.ok)throw new Error("Erro ao carregar notificações");const f=await i.json();x(f.notificacoes)}catch(i){console.error("Erro ao carregar notificações:",i)}},[r,t]),D=a.useCallback(async i=>{try{await fetch(`/api/comunicacao/notificacoes/${i}/ler`,{method:"POST"}),x(f=>f.map(S=>S.id===i?{...S,lida:!0}:S))}catch(f){console.error("Erro ao marcar notificação como lida:",f)}},[]),z=a.useCallback(async i=>{try{const f=await fetch(`/api/comunicacao/usuarios?q=${encodeURIComponent(i)}&userType=${t}`);if(!f.ok)throw new Error("Erro ao buscar usuários");return(await f.json()).usuarios}catch(f){return console.error("Erro ao buscar usuários:",f),[]}},[t]),k=a.useCallback(async()=>{try{const i=await fetch("/api/comunicacao/status-online");if(!i.ok)throw new Error("Erro ao verificar status online");const f=await i.json();E(new Set(f.online))}catch(i){console.error("Erro ao verificar status online:",i)}},[]),l=a.useCallback(async(i,f,S,w)=>{try{const N=o.find(V=>V.tipo==="individual"&&V.participantes.some(U=>U.id===i&&U.tipo===f));let C=N==null?void 0:N.id;return C||(C=(await O([{id:i,tipo:f}])).id),await A(C,S,w)}catch(N){throw console.error("Erro ao enviar mensagem direta:",N),N}},[o,O,A]),b=a.useCallback(async i=>{try{if(!(await fetch(`/api/comunicacao/conversas/${i}`,{method:"DELETE"})).ok)throw new Error("Erro ao deletar conversa");n(S=>S.filter(w=>w.id!==i)),(s==null?void 0:s.id)===i&&(c(null),m([]))}catch(f){g(f instanceof Error?f.message:"Erro desconhecido"),console.error("Erro ao deletar conversa:",f)}},[s]);return a.useEffect(()=>{let i=null;const f=()=>{i=new WebSocket(`ws://localhost:5000/ws/comunicacao?userId=${r}&userType=${t}`),i.onopen=()=>{console.log("WebSocket conectado")},i.onmessage=S=>{const w=JSON.parse(S.data);switch(w.tipo){case"nova_mensagem":(s==null?void 0:s.id)===w.conversaId&&m(N=>[...N,w.mensagem]),n(N=>N.map(C=>C.id===w.conversaId?{...C,ultimaMensagem:{texto:w.mensagem.texto,timestamp:new Date(w.mensagem.timestamp),remetente:w.mensagem.remetente.id},naoLidas:C.naoLidas+1}:C));break;case"usuario_online":E(N=>new Set([...N,w.userId]));break;case"usuario_offline":E(N=>{const C=new Set(N);return C.delete(w.userId),C});break;case"nova_notificacao":x(N=>[w.notificacao,...N]);break}},i.onclose=()=>{console.log("WebSocket desconectado"),setTimeout(f,3e3)},i.onerror=S=>{console.error("Erro no WebSocket:",S)}};return f(),()=>{i&&i.close()}},[r,t,s]),a.useEffect(()=>{_(),T(),k()},[_,T,k]),{conversas:o,conversaAtiva:s,mensagens:d,notificacoes:h,loading:u,error:p,online:j,setConversaAtiva:c,carregarConversas:_,carregarMensagens:P,enviarMensagem:A,criarConversa:O,marcarComoLidas:L,carregarNotificacoes:T,marcarNotificacaoComoLida:D,buscarUsuarios:z,verificarStatusOnline:k,enviarMensagemDireta:l,deletarConversa:b,limparError:()=>g(null)}}function yr(){const[r,t]=a.useState("chat"),[,o]=He(),n="1",s="empresa",{conversas:c,notificacoes:d,loading:m,error:h,online:x,carregarConversas:u,carregarNotificacoes:v,marcarNotificacaoComoLida:p}=xr({userId:n,userType:s}),g=d.filter(j=>!j.lida).length;return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(y,{variant:"outline",onClick:()=>o("/admin"),className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4"}),"Voltar ao Admin"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sistema de Comunicação"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie comunicação entre candidatos e empresas"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(H,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),x.size," usuários online"]}),e.jsxs(y,{children:[e.jsx(qe,{className:"h-4 w-4 mr-2"}),"Nova Conversa"]})]})]}),e.jsxs(Be,{value:r,onValueChange:t,className:"space-y-6",children:[e.jsxs($e,{className:"grid w-full grid-cols-3",children:[e.jsxs(se,{value:"chat",className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-4 w-4"}),"Chat (",c.length,")"]}),e.jsxs(se,{value:"notificacoes",className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-4 w-4"}),"Notificações",g>0&&e.jsx(H,{variant:"destructive",className:"h-5 w-5 rounded-full p-0 text-xs",children:g})]}),e.jsxs(se,{value:"configuracoes",className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-4 w-4"}),"Configurações"]})]}),e.jsx(te,{value:"chat",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-4",children:[e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{className:"text-lg",children:"Estatísticas"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Conversas Ativas"}),e.jsx(H,{variant:"secondary",children:c.filter(j=>j.ativa).length})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Mensagens Não Lidas"}),e.jsx(H,{variant:"destructive",children:c.reduce((j,E)=>j+E.naoLidas,0)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Empresas Conectadas"}),e.jsx(H,{variant:"outline",children:Math.floor(x.size/2)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Candidatos Online"}),e.jsx(H,{variant:"outline",children:Math.ceil(x.size/2)})]})]})]}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{className:"text-lg",children:"Ações Rápidas"})}),e.jsxs(B,{className:"space-y-2",children:[e.jsxs(y,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Criar Grupo"]}),e.jsxs(y,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Arquivar Conversas"]}),e.jsxs(y,{variant:"outline",className:"w-full justify-start",children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Limpar Histórico"]})]})]})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(ur,{userId:n,userType:s})})]})}),e.jsxs(te,{value:"notificacoes",className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(y,{variant:"outline",size:"sm",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Filtrar"]}),e.jsx(y,{variant:"outline",size:"sm",children:"Marcar Todas como Lidas"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Pesquisar notificações...",className:"border rounded-lg px-3 py-2 text-sm"})]})]}),e.jsxs("div",{className:"space-y-4",children:[d.map(j=>e.jsx(W,{className:`${j.lida?"":"border-blue-200 bg-blue-50"}`,children:e.jsx(B,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-medium",children:j.titulo}),!j.lida&&e.jsx(H,{variant:"default",className:"bg-blue-100 text-blue-800",children:"Nova"}),e.jsx(H,{variant:"outline",className:"text-xs",children:j.tipo})]}),e.jsx("p",{className:"text-gray-600 text-sm mb-2",children:j.mensagem}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsx("span",{children:new Date(j.timestamp).toLocaleString("pt-BR")}),j.acao&&e.jsx(y,{variant:"link",size:"sm",className:"p-0 h-auto",children:"Ver detalhes"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!j.lida&&e.jsx(y,{size:"sm",variant:"outline",onClick:()=>p(j.id),children:"Marcar como lida"}),e.jsx(y,{size:"sm",variant:"ghost",children:e.jsx(je,{className:"h-4 w-4"})})]})]})})},j.id)),d.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(fe,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Nenhuma notificação encontrada"})]})]})]}),e.jsx(te,{value:"configuracoes",className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Configurações de Notificações"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Notificações por Email"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Notificações Push"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Som de Notificação"}),e.jsx("input",{type:"checkbox",className:"rounded"})]})]})]}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Configurações de Privacidade"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Mostrar Status Online"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Confirmar Leitura"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:"Histórico de Mensagens"}),e.jsx("input",{type:"checkbox",defaultChecked:!0,className:"rounded"})]})]})]}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Configurações de Chat"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tamanho da Fonte"}),e.jsxs("select",{className:"w-full mt-1 border rounded-lg px-3 py-2",children:[e.jsx("option",{children:"Pequeno"}),e.jsx("option",{selected:!0,children:"Médio"}),e.jsx("option",{children:"Grande"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Tema"}),e.jsxs("select",{className:"w-full mt-1 border rounded-lg px-3 py-2",children:[e.jsx("option",{selected:!0,children:"Claro"}),e.jsx("option",{children:"Escuro"}),e.jsx("option",{children:"Sistema"})]})]})]})]}),e.jsxs(W,{children:[e.jsx(X,{children:e.jsx(Y,{children:"Exportar Dados"})}),e.jsxs(B,{className:"space-y-4",children:[e.jsx(y,{variant:"outline",className:"w-full",children:"Exportar Histórico de Conversas"}),e.jsx(y,{variant:"outline",className:"w-full",children:"Exportar Notificações"}),e.jsx(y,{variant:"outline",className:"w-full",children:"Backup Completo"})]})]})]})})]})]})}export{yr as default};
